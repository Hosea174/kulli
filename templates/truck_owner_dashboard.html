{% extends "base.html" %}

{% block title %}Truck Owner Dashboard{% endblock %}

{% block content %}
<div class="dashboard">
  <h2>Welcome, {{ current_user.name }}</h2>
  <h3>Your Transport Trips</h3>
  <table class="trip-table">
    <thead>
      <tr>
        <th>Pickup</th>
        <th>Destination</th>
        <th>Distance</th>
        <th>Price</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for trip in trips %}
      <tr>
        <td>{{ trip.pickup_location }}</td>
        <td>{{ trip.destination }}</td>
        <td>{{ "%.2f"|format(trip.est_distance) }} km</td>
        <td>â‚¬{{ "%.2f"|format(trip.est_price) }}</td>
        <td>
          <span class="status-badge status-{{ trip.status }}">
            {{ trip.status|replace('_', ' ')|title }}
          </span>
        </td>
        <td>
          {% if trip.status == 'waiting' %}
          <form method="POST" action="{{ url_for('truck_owner_dashboard') }}">
            <input type="hidden" name="trip_id" value="{{ trip.id }}">
            <button type="submit" class="btn-primary">Accept</button>
          </form>
          {% else %}
          <form method="POST" action="{{ url_for('update_trip_status') }}">
            <input type="hidden" name="trip_id" value="{{ trip.id }}">
            <select name="status" class="status-select">
              <option value="truck_assigned" {% if trip.status == 'truck_assigned' %}selected{% endif %}>Truck Assigned</option>
              <option value="started" {% if trip.status == 'started' %}selected{% endif %}>Started</option>
              <option value="completed" {% if trip.status == 'completed' %}selected{% endif %}>Completed</option>
              <option value="canceled" {% if trip.status == 'canceled' %}selected{% endif %}>Canceled</option>
            </select>
            <button type="submit" class="btn-secondary">Update</button>
          </form>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
